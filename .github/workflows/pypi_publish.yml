name: Publish to PyPI

run-name: Publish to PyPI

on:
  workflow_dispatch:
    inputs:
      python_version:
        description: "Python version to use (default: 3.12)"
        required: false
        default: "3.12"
        type: string
      version:
        description: "Version being published (for approval message)"
        required: false
        default: "latest"
        type: string

jobs:
  wait-for-approval:
    uses: ./.github/workflows/manual_approver.yaml
    with:
      version: ${{ inputs.version }}

  publish-to-pypi:
    needs: wait-for-approval
    uses: ./.github/workflows/poetry_publish.yaml
    with:
      python_version: ${{ inputs.python_version || '3.12' }}
    secrets:
      PYPI_TOKEN: ${{ secrets.PYPI_TOKEN }}
